{{template "base.html" .}}

{{define "content"}}
<div class="row">
    <div class="col">
        <div class="card">
            <div class="card-header">
                <h2>Панель управления1</h2>
                <button class="btn btn-primary" onclick="refreshStats()">Обновить</button>
            </div>
        </div>
    </div>
</div>

<!-- Статистика -->
<div class="row" id="statsSection">
    <div class="col-3">
        <div class="card">
            <div class="card-body text-center">
                <div class="stat-number" id="totalClients">0</div>
                <div class="stat-label">Всего клиентов</div>
            </div>
        </div>
    </div>
    <div class="col-3">
        <div class="card">
            <div class="card-body text-center">
                <div class="stat-number" id="activeClients">0</div>
                <div class="stat-label">Активных</div>
            </div>
        </div>
    </div>
    <div class="col-3">
        <div class="card">
            <div class="card-body text-center">
                <div class="stat-number" id="disabledClients">0</div>
                <div class="stat-label">Отключено</div>
            </div>
        </div>
    </div>
    <div class="col-3">
        <div class="card">
            <div class="card-body text-center">
                <div class="stat-number" id="downloadedCount">0</div>
                <div class="stat-label">Скачали конфиг</div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <!-- Управление сервером -->
    <div class="col-6">
        <div class="card">
            <div class="card-header">
                <h3>Конфигурация сервера</h3>
            </div>
            <div class="card-body">
                <div style="margin-bottom: 1rem;">
                    <button type="button" class="btn btn-secondary" onclick="createNewServer()">Создать сервер</button>
                </div>
                <form id="serverForm">
                    <div class="form-group">
                        <label for="serverName">Название сервера</label>
                        <input type="text" class="form-control" id="serverName" required>
                    </div>
                    <div class="form-group">
                        <label for="serverPort">Порт</label>
                        <input type="number" class="form-control" id="serverPort" value="51820" required>
                    </div>
                    <div class="form-group">
                        <label for="serverNetwork">Сеть</label>
                        <input type="text" class="form-control" id="serverNetwork" value="10.0.0.0/24" required>
                    </div>
                    <div class="form-group">
                        <label for="serverDNS">DNS</label>
                        <input type="text" class="form-control" id="serverDNS" value="8.8.8.8" required>
                    </div>
                    <div class="form-group">
                        <label for="serverEndpoint">Endpoint (IP:порт)</label>
                        <input type="text" class="form-control" id="serverEndpoint" placeholder="192.168.1.100:51820" required>
                    </div>
                    <div class="form-group">
                        <label for="serverAllowedIPs">AllowedIPs</label>
                        <input type="text" class="form-control" id="serverAllowedIPs" value="0.0.0.0/0" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Сохранить сервер</button>
                </form>
                
                <div class="mt-3" id="serverInfo" style="display: none;">
                    <h6>Текущая конфигурация:</h6>
                    <div class="p-2">
                        <small>
                            <strong>ID:</strong> <span id="currentServerId"></span><br>
                            <strong>Порт:</strong> <span id="currentServerPort"></span><br>
                            <strong>Сеть:</strong> <span id="currentServerNetwork"></span><br>
                            <strong>Endpoint:</strong> <span id="currentServerEndpoint"></span>
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Добавление клиента -->
    <div class="col-6">
        <div class="card">
            <div class="card-header">
                <h3>Добавить клиента</h3>
            </div>
            <div class="card-body">
                <form id="clientForm">
                    <div class="form-group">
                        <label for="clientName">Имя клиента</label>
                        <input type="text" class="form-control" id="clientName" required>
                    </div>
                    <div class="form-group">
                        <label for="clientEmail">Email (опционально)</label>
                        <input type="email" class="form-control" id="clientEmail">
                    </div>
                    <button type="submit" class="btn btn-success">Добавить клиента</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Список клиентов -->
<div class="row">
    <div class="col">
        <div class="card">
            <div class="card-header">
                <h3>Клиенты</h3>
            </div>
            <div class="card-body">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Имя</th>
                            <th>Email</th>
                            <th>IP адрес</th>
                            <th>Статус</th>
                            <th>Конфиг</th>
                            <th>Действия</th>
                        </tr>
                    </thead>
                    <tbody id="clientsTableBody">
                        <tr>
                            <td colspan="6" class="text-center">
                                Загрузка клиентов...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
{{end}}